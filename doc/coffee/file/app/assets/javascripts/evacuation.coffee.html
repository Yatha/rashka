<!DOCTYPE html>
<html>
  <head>
  <meta charset='UTF-8'>
  <title>CoffeeScript API Documentation</title>
  <script src='../../../../javascript/application.js'></script>
  <script src='../../../../javascript/search.js'></script>
  <link rel='stylesheet' href='../../../../stylesheets/application.css' type='text/css'>
</head>
  <body>
    <div id='base' data-path='../../../../'></div>
<div id='header'>
  <div id='menu'>
    <a href='../../../../extra/README.md.html' title='Rashka'>
      Rashka
    </a>
    &raquo;
    <a href='../../../../alphabetical_index.html' title='Index'>
      Index
    </a>
    &raquo;
    <span class='title'>app</span>
    &raquo;
    <span class='title'>assets</span>
    &raquo;
    <span class='title'>javascripts</span>
    &raquo;
    <span class='title'>evacuation.coffee</span>
  </div>
</div>
    <div id='content'>
      <h1>
        File:
        evacuation.coffee
      </h1>
      <table class='box'>
        <tr>
          <td>Defined in:</td>
          <td>app&#47;assets&#47;javascripts</td>
        </tr>
      </table>
      <h2>Variables Summary</h2>
      <dl class='constants'>
  <dt id='evacuation-variable'>
    evacuation
    =
  </dt>
  <dd>
    <pre><code class='coffeescript'>{
  dom_element: $(&quot;#evac_btn&quot;),

  &#47;*
  Запуск слушателя при нажатии
   *&#47;
  init: function() {
    return $(evacuation.dom_element).click(function() {
      evacuation.get_directions(app.current_location, app.places.closest);
      evacuation.share_mode_on();
      return evacuation.evac_stat_increase();
    });
  },

  &#47;*
  Скрывает кнопку валить и показывает кнопку рассказать
   *&#47;
  share_mode_on: function() {
    this.dom_element.addClass(&quot;hidden&quot;);
    return $(&quot;#share_btn&quot;).removeClass(&quot;hidden&quot;);
  },

  &#47;*
  Запускает метод увеличения статистики
   *&#47;
  evac_stat_increase: function() {
    return $.ajax(&quot;..&#47;stats&#47;evacuate&quot;, {
      type: &quot;POST&quot;,
      dataType: &quot;json&quot;,

      &#47;*
      В случае успеха обновляет поле текста случайной причиной
       *&#47;
      success: function(reason_text) {
        $(&quot;#reason_field&quot;).val(reason_text);
        $(&quot;#reason_field&quot;).trigger(&quot;change&quot;);
        return console.log(&quot;yeahhhhhh&quot;);
      },
      error: function() {
        return console.log(&quot;nooooo&quot;);
      }
    });
  },

  &#47;*
  Строит маршрут до ближайшего места
  @param start_point [google.maps.LatLng] место начала
  @param end_place [Object] место конца
   *&#47;
  get_directions: function(start_point, end_place) {
    var directions_service, directions_service_options, end_point;
    end_point = new google.maps.LatLng(end_place.lat, end_place.lng);
    directions_service = new google.maps.DirectionsService();
    directions_service_options = evacuation.get_directions_service_options(start_point, end_point);
    return directions_service.route(directions_service_options, function(response, status) {
      if (status === google.maps.DirectionsStatus.OK) {
        evacuation.show_directions(response);
        return evacuation.create_end_place_infobox(end_place);
      }
    });
  },

  &#47;*
  Отображение инфобокса у места
  @param end_point [google.maps.LatLng] место конца маршрута
   *&#47;
  create_end_place_infobox: function(end_point) {
    var infobox_content, place_infobox;
    place_infobox = new InfoBox(app.infobox_options);
    infobox_content = &quot;&lt;p&gt;&lt;b&gt;&quot; + end_point.type + &quot; :&lt;&#47;b&gt; &quot; + end_point.name + &quot; &lt;&#47;p&gt; &lt;p&gt;&lt;b&gt;Расстояние:&lt;&#47;b&gt; &quot; + (end_point.distance.toFixed(1)) + &quot; км&lt;&#47;p&gt;&quot;;
    place_infobox.setContent(infobox_content);
    return place_infobox.open(app.google_map, end_point.marker);
  },

  &#47;*
  Создает рендерер для маршрута
  @return [google.maps.DirectionsRenderer] рендерер маршрута
   *&#47;
  get_directions_renderer: function() {
    var directions_renderer_options;
    directions_renderer_options = {
      map: app.google_map,
      suppressMarkers: true
    };
    return new google.maps.DirectionsRenderer(directions_renderer_options);
  },

  &#47;*
  Настройки отображения маршрута
  @param start_point [google.maps.LatLng] место начала
  @param end_point [google.maps.LatLng] место конца маршрута
  @return [Object] настройки маршрута
   *&#47;
  get_directions_service_options: function(start_point, end_point) {
    return {
      origin: start_point,
      destination: end_point,
      travelMode: google.maps.TravelMode.DRIVING
    };
  },

  &#47;*
  Отображение маршрута на карте
  @param response [Маршрут] маршрут до места
   *&#47;
  show_directions: function(response) {
    var directions_renderer;
    directions_renderer = evacuation.get_directions_renderer();
    directions_renderer.setDirections(response);
    app.directions_renderer = directions_renderer;
    return console.log(&quot;Вам надо всего-то &quot; + response.routes[0].legs[0].duration.text + &quot; ехать на машине и вы свалите из этой замечательной страны!&quot;);
  }
}</code></pre>
    <div class='docstring'>
  <p>Параметры и функции, связанные с эвакуацией</p>
</div>
<div class='tags'>
</div>
  </dd>
</dl>
    </div>
    <div id='footer'>
  February 18, 14 19:34:41 by
  <a href='https://github.com/coffeedoc/codo' title='CoffeeScript API documentation generator'>
    Codo
  </a>
  2.0.6
  &#10034;
  Press H to see the keyboard shortcuts
  &#10034;
  <a href='http://twitter.com/netzpirat' target='_parent'>@netzpirat</a>
  &#10034;
  <a href='http://twitter.com/_inossidabile' target='_parent'>@_inossidabile</a>
</div>
<iframe id='search_frame'></iframe>
<div id='fuzzySearch'>
  <input type='text'>
  <ol></ol>
</div>
<div id='help'>
  <p>
    Quickly fuzzy find classes, mixins, methods, file:
  </p>
  <ul>
    <li>
      <span>T</span>
      Open fuzzy finder dialog
    </li>
  </ul>
  <p>
    Control the navigation frame:
  </p>
  <ul>
    <li>
      <span>L</span>
      Toggle list view
    </li>
    <li>
      <span>C</span>
      Show class list
    </li>
    <li>
      <span>I</span>
      Show mixin list
    </li>
    <li>
      <span>F</span>
      Show file list
    </li>
    <li>
      <span>M</span>
      Show method list
    </li>
    <li>
      <span>E</span>
      Show extras list
    </li>
  </ul>
  <p>
    You can focus and blur the search input:
  </p>
  <ul>
    <li>
      <span>S</span>
      Focus search input
    </li>
    <li>
      <span>Esc</span>
      Blur search input
    </li>
  </ul>
</div>
  </body>
</html>